<!DOCTYPE html>
<html>
  <head>
    <title>Login</title>

    <!-- Firebase COMPAT SDKs (REQUIRED) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  </head>

  <body>
    <h2>Login with Google</h2>
    <button onclick="login()">Login</button>

    <script>
      // ðŸ”¹ Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyDan9cZhjlRh6E2NJazWMgjBVr7oH9kUxU",
        authDomain: "math-mcp.firebaseapp.com",
        projectId: "math-mcp",
        appId: "1:401877262712:web:1264b476306f7f8922e88d"
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();

      async function login() {
        try {
          const provider = new firebase.auth.GoogleAuthProvider();

          // Google sign-in popup
          const result = await auth.signInWithPopup(provider);

          // Get Firebase ID token
          const idToken = await result.user.getIdToken();

          // ðŸ”‘ Send token to backend
          await fetch("/auth/callback", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ idToken })
          });

          // ðŸ”´ DO NOTHING ELSE
          // Backend will:
          // 1. postMessage token to Claude
          // 2. close the window
        } catch (err) {
          alert("Login failed: " + err.message);
          console.error(err);
        }
      }
    </script>
  </body>
</html>


